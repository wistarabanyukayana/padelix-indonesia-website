(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43293,e=>{"use strict";let t=(0,e.i(98631).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],43293)},16024,e=>{"use strict";let t=(0,e.i(98631).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],16024)},66053,e=>{"use strict";var t=e.i(52160);let a=(0,t.createServerReference)("40d1fbcb5529ac8f2bc18816eb1d3c478818f9fbe2",t.callServer,void 0,t.findSourceMapURL,"uploadFile");e.s(["uploadFile",()=>a])},79489,e=>{"use strict";var t=e.i(52160);let a=(0,t.createServerReference)("4020377e801a0cc64e1a42febf16bf8e4995f2cf7f",t.callServer,void 0,t.findSourceMapURL,"deleteMedia");e.s(["deleteMedia",()=>a])},31035,68541,e=>{"use strict";var t=e.i(52160);let a=(0,t.createServerReference)("600e0cdbe2c8d63481951c01b9e5bebcf0b714ea4a",t.callServer,void 0,t.findSourceMapURL,"createMuxUpload");e.s(["createMuxUpload",()=>a],31035);let s=(0,t.createServerReference)("40525e4ba1a0943968fe44ab212718ec6b0c2f1338",t.callServer,void 0,t.findSourceMapURL,"getMuxMediaByUploadId");e.s(["getMuxMediaByUploadId",()=>s],68541)},9958,5109,35881,54267,e=>{"use strict";var t=e.i(98631);let a=(0,t.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>a],9958);let s=(0,t.default)("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);e.s(["FolderPlus",()=>s],5109);let r=(0,t.default)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);e.s(["RefreshCcw",()=>r],35881);let l=(0,t.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>l],54267)},31523,30019,33858,6222,42780,20154,66974,32098,6947,e=>{"use strict";var t=e.i(52160);let a=(0,t.createServerReference)("60a088e6d105144a94fa2824812100df7fdd6a8818",t.callServer,void 0,t.findSourceMapURL,"updateMediaFolder");e.s(["updateMediaFolder",()=>a],31523);let s=(0,t.createServerReference)("00407ab671b4a0818fff7ed31ffb79f10f964adcd8",t.callServer,void 0,t.findSourceMapURL,"syncFileSystemMedias");e.s(["syncFileSystemMedias",()=>s],30019);let r=(0,t.createServerReference)("406ff7d3af401edf92b2984e240871274e46bb3446",t.callServer,void 0,t.findSourceMapURL,"createPhysicalFolder");e.s(["createPhysicalFolder",()=>r],33858);let l=(0,t.createServerReference)("0039e6f4d93c612e9432cd78ee8cbc92260a14fa7c",t.callServer,void 0,t.findSourceMapURL,"getPhysicalFolders");e.s(["getPhysicalFolders",()=>l],6222);let i=(0,t.createServerReference)("40c944e5b0c4c33ee1ee96067b7c69a49106edc40b",t.callServer,void 0,t.findSourceMapURL,"deletePhysicalFolder");e.s(["deletePhysicalFolder",()=>i],42780);let n=(0,t.createServerReference)("4061d271ac6c933535c19513a8303b6043c76aa3b4",t.callServer,void 0,t.findSourceMapURL,"syncMuxAssetStatus");e.s(["syncMuxAssetStatus",()=>n],20154);let d=(0,e.i(98631).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>d],66974);var o=e.i(80506),c=e.i(28781),u=e.i(778),x=e.i(50919);function h({isOpen:e,onClose:t,title:a,children:s,footer:r}){let[l,i]=(0,u.useState)(!1);return((0,u.useEffect)(()=>{i(!0)},[]),(0,u.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),l&&e)?(0,x.createPortal)((0,o.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-200 border border-neutral-200",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-neutral-100",children:[(0,o.jsx)("h3",{className:"font-bold text-lg text-neutral-900",children:a}),(0,o.jsx)("button",{onClick:t,className:"p-1 rounded-full hover:bg-neutral-100 text-neutral-500 transition-colors",children:(0,o.jsx)(c.X,{size:20})})]}),(0,o.jsx)("div",{className:"p-4 overflow-y-auto max-h-[70vh]",children:s}),r&&(0,o.jsx)("div",{className:"p-4 bg-neutral-50 border-t border-neutral-100 flex justify-end gap-2",children:r})]})}),document.body):null}e.s(["Modal",()=>h],32098);var p=e.i(55200);function m({isOpen:e,onClose:t,onCreate:a,currentPath:s}){let[r,l]=(0,u.useState)("");return(0,o.jsx)(h,{isOpen:e,onClose:t,title:"Buat Folder Baru",children:(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r.trim()&&(a(r.trim()),l(""),t())},className:"flex flex-col gap-4",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)("label",{className:"text-sm font-bold text-neutral-700",children:"Nama Folder"}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,o.jsxs)("span",{className:"text-neutral-400 text-sm",children:[s,"/"]}),(0,o.jsx)("input",{autoFocus:!0,type:"text",className:"p-2 border rounded-lg flex-1",placeholder:"Contoh: products",value:r,onChange:e=>l(e.target.value)})]}),(0,o.jsx)("p",{className:"text-xs text-neutral-500",children:"Folder hanya akan tersimpan jika berisi file."})]}),(0,o.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,o.jsx)(p.Button,{type:"button",variant:"outline",onClick:t,children:"Batal"}),(0,o.jsx)(p.Button,{type:"submit",disabled:!r.trim(),children:"Buat Folder"})]})]})})}e.s(["FolderDialog",()=>m],6947)},57267,74111,e=>{"use strict";var t=e.i(80506),a=e.i(32098),s=e.i(55200),r=e.i(778),l=e.i(43293),i=e.i(19364),n=e.i(58975);function d({isOpen:e,onClose:d,onMove:o,existingFolders:c,currentFolder:u}){let[x,h]=(0,r.useState)(u),[p,m]=(0,r.useState)(!1),[f,g]=(0,r.useState)(""),b=(0,r.useMemo)(()=>{let e=[];return e.push({id:"root",label:"Root (Tanpa Folder)",path:null}),c.forEach(t=>{let a,s,r;return a=t.split("/"),s=e,r="",void a.forEach((e,t)=>{r=r?`${r}/${e}`:e;let l=s.find(t=>t.label===e&&"root"!==t.id);l||(l={id:r,label:e,path:r,children:[]},s.push(l)),t<a.length-1&&(l.children||(l.children=[]),s=l.children)})}),e},[c]);return(0,t.jsx)(a.Modal,{isOpen:e,onClose:d,title:"Pindahkan Media",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("p",{className:"text-sm text-neutral-500",children:"Pilih folder tujuan."}),(0,t.jsx)("div",{className:"max-h-[300px] overflow-y-auto border rounded-lg p-2 bg-white",children:(0,t.jsx)(n.CollapsibleTree,{nodes:b,renderLabel:e=>{let a=x===e.path;return(0,t.jsxs)("button",{type:"button",onClick:()=>{h(e.path??null),m(!1)},className:`flex items-center gap-2 w-full p-1 rounded text-sm text-left hover:bg-neutral-100 transition-all ${a?"text-brand-green font-bold bg-brand-light/20":"text-neutral-700"}`,children:[(0,t.jsx)(i.Folder,{size:14,className:a?"fill-brand-green/20 stroke-brand-green":"text-neutral-400"}),(0,t.jsx)("span",{children:e.label})]})},defaultExpanded:!0})}),(0,t.jsxs)("div",{className:"border-t border-neutral-200 pt-4",children:[(0,t.jsxs)("button",{onClick:()=>m(!p),className:"flex items-center gap-2 text-sm font-bold text-brand-green mb-2",children:[(0,t.jsx)(l.Plus,{size:16})," Folder Baru"]}),p&&(0,t.jsx)("div",{className:"flex flex-col gap-2 animate-in slide-in-from-top-2 duration-200",children:(0,t.jsx)("input",{type:"text",placeholder:"Nama folder baru (contoh: archive/2024)",className:"p-2 border rounded text-sm",value:f,onChange:e=>g(e.target.value),autoFocus:!0})})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,t.jsx)(s.Button,{variant:"outline",onClick:d,children:"Batal"}),(0,t.jsx)(s.Button,{onClick:()=>{p?o(f.trim()||null):o(x),d()},disabled:p&&!f.trim(),children:"Pindahkan"})]})]})})}e.s(["MoveMediaDialog",()=>d],57267);var o=e.i(31924),c=e.i(61771),u=e.i(98631);let x=(0,u.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),h=(0,u.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),p=(0,u.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),m=(0,u.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),f=(0,u.default)("file-type",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]]),g=(0,u.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),b=(0,u.default)("move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]);var v=e.i(14136),y=e.i(14346);let j=(0,u.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var N=e.i(54219),w=e.i(70612),k=e.i(40167),M=e.i(28015);function S({isOpen:e,onClose:l,media:i,onMove:n,onDelete:d}){let[u,S]=(0,r.useState)(!1);if(!i)return null;let z=(0,o.parseMetadata)(i.metadata),C=z.folder||(i.url.split("/").length>3?i.url.split("/").slice(2,-1).join("/"):"Root"),F="video"===i.type&&"mux"===i.provider&&"ready"===z.status;return(0,t.jsxs)(a.Modal,{isOpen:e,onClose:l,title:"Detail Media",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)("div",{className:"w-full bg-neutral-100 rounded-lg overflow-hidden flex items-center justify-center border border-neutral-200 aspect-video relative group",children:"image"===i.type?(0,t.jsxs)("div",{className:"relative w-full h-full cursor-zoom-in",onClick:()=>S(!0),children:[(0,t.jsx)(c.AppImage,{src:i.url,alt:i.name,fill:!0,className:"object-contain"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/5 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,t.jsx)("div",{className:"bg-white/90 p-2 rounded-full shadow-lg",children:(0,t.jsx)(j,{size:20,className:"text-neutral-700"})})})]}):F?(0,t.jsx)(w.default,{playbackId:z.playbackId,metadata:{video_title:i.name},style:{height:"100%",width:"100%"}}):(0,t.jsxs)("div",{className:"p-12 flex flex-col items-center justify-center gap-4 text-neutral-400",children:["video"===i.type?(0,t.jsx)(y.Play,{size:48,className:"animate-pulse"}):(0,t.jsx)(f,{size:48}),(0,t.jsx)("span",{className:"text-sm font-mono",children:i.mimeType}),"video"===i.type&&!F&&(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase bg-yellow-100 text-yellow-700 px-2 py-1 rounded",children:"Processing..."})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,t.jsx)(m,{size:12})," Ukuran File"]}),(0,t.jsxs)("span",{className:"font-medium text-neutral-900",children:[(i.fileSize/1024).toFixed(2)," KB"]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,t.jsx)(f,{size:12})," Tipe MIME"]}),(0,t.jsx)("span",{className:"font-medium text-neutral-900",children:i.mimeType})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,t.jsx)(g,{size:12})," Folder"]}),(0,t.jsx)("span",{className:"font-medium text-neutral-900",children:C})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,t.jsx)(p,{size:12})," Diunggah"]}),(0,t.jsx)("span",{className:"font-medium text-neutral-900",children:new Date(i.createdAt).toLocaleDateString("id-ID")})]})]}),(0,t.jsx)("div",{className:"bg-neutral-50 p-3 rounded border border-neutral-100 break-all text-xs font-mono text-neutral-600",children:i.name}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 pt-4 border-t border-neutral-200",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[n&&(0,t.jsxs)(s.Button,{variant:"outline",onClick:()=>{n(i),l()},size:"sm",className:"gap-2 justify-start",children:[(0,t.jsx)(b,{size:16,className:"text-blue-600"})," Pindahkan"]}),d&&(0,t.jsxs)(s.Button,{variant:"outline",onClick:()=>{d(i.id),l()},size:"sm",className:"gap-2 justify-start text-red-600 hover:bg-red-50 border-red-200",children:[(0,t.jsx)(v.Trash2,{size:16})," Hapus Permanen"]})]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsxs)(s.Button,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(i.url),N.toast.success("URL disalin ke clipboard!")},size:"sm",className:"gap-2",children:[(0,t.jsx)(h,{size:16})," Salin URL"]}),(0,t.jsx)("a",{href:i.url,download:!0,target:"_blank",rel:"noreferrer",children:(0,t.jsxs)(s.Button,{variant:"dark",size:"sm",className:"gap-2",children:[(0,t.jsx)(x,{size:16})," Download"]})})]})]})]}),"image"===i.type&&(0,t.jsx)(k.default,{open:u,close:()=>S(!1),slides:[{src:i.url,alt:i.name}],plugins:[M.default],zoom:{maxZoomPixelRatio:3}})]})}e.s(["MediaDetailsModal",()=>S],74111)},53978,e=>{"use strict";var t=e.i(80506),a=e.i(778),s=e.i(61771),r=e.i(55200),l=e.i(14346),i=e.i(49202),n=e.i(53281),d=e.i(16024),o=e.i(9958),c=e.i(19364),u=e.i(86914),x=e.i(5109),h=e.i(35881),p=e.i(54267),m=e.i(14136),f=e.i(79489),g=e.i(31523),b=e.i(30019),v=e.i(33858),y=e.i(6222),j=e.i(42780),N=e.i(20154),w=e.i(58294),k=e.i(66974),M=e.i(6947),S=e.i(57267),z=e.i(74111),C=e.i(43293),F=e.i(28781),R=e.i(66053),P=e.i(31035),B=e.i(68541),U=e.i(54219);function A({currentFolder:e}){let[s,r]=(0,a.useState)(!1),[l,i]=(0,a.useState)(0),n=(0,w.useRouter)(),d=(0,a.useRef)(null),o=(0,a.useRef)(null),c=async()=>{d.current&&(d.current.abort(),d.current=null,o.current&&(await (0,f.deleteMedia)(o.current),o.current=null),r(!1),i(0),U.toast.info("Unggahan dibatalkan"))},u=async t=>{if(t){r(!0),i(0);try{if(t.type.startsWith("video/")){let a=await (0,P.createMuxUpload)(t.name,e),s=await (0,B.getMuxMediaByUploadId)(a.id);s&&(o.current=s.id);let r=new XMLHttpRequest;d.current=r,r.open("PUT",a.url),r.upload.onprogress=e=>{e.lengthComputable&&i(Math.round(e.loaded/e.total*100))};let l=new Promise((e,t)=>{r.onload=()=>r.status>=200&&r.status<300?e(r.response):t(Error("Mux upload failed")),r.onerror=()=>t(Error("Mux upload error")),r.onabort=()=>t("ABORTED")});r.send(t),await l,d.current=null,o.current=null;let n=0;for(;n<10;)try{let e=await (0,B.getMuxMediaByUploadId)(a.id);if(e&&e.url)break;n++,await new Promise(e=>setTimeout(e,2e3))}catch{n++,await new Promise(e=>setTimeout(e,2e3))}U.toast.success("Video berhasil diunggah")}else{let a=new FormData;a.append("file",t),e&&a.append("folder",e);let s=await (0,R.uploadFile)(a);s.error?U.toast.error(s.error):U.toast.success("File berhasil diunggah")}n.refresh()}catch(e){if("ABORTED"===e)return;console.error("Upload error:",e),U.toast.error("Gagal mengunggah file.")}finally{r(!1),i(0)}}};return(0,t.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,t.jsx)("input",{type:"file",id:"media-upload",className:"hidden",onChange:e=>e.target.files?.[0]&&u(e.target.files[0]),disabled:s}),(0,t.jsx)("label",{htmlFor:"media-upload",className:"inline-flex items-center justify-center rounded-brand transition-all active:scale-95 disabled:opacity-50 bg-brand-dark text-white hover:bg-black px-4 py-2 text-sm font-medium gap-2 shadow-lg cursor-pointer",children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("span",{children:l>0?`${l}%`:"Mengunggah..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Plus,{size:18}),(0,t.jsx)("span",{children:"Unggah Media"})]})}),s&&(0,t.jsx)("button",{onClick:c,className:"p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition-colors shadow-sm",title:"Batalkan Unggahan",children:(0,t.jsx)(F.X,{size:16})})]})}var L=e.i(31924);let $=e=>{if(!e)return{};if("string"==typeof e)try{return JSON.parse(e)}catch{return{}}if("object"==typeof e&&null!==e&&"0"in e&&"1"in e)try{let t=[];Object.keys(e).forEach(a=>{isNaN(Number(a))||(t[t.length]=e[a])});let a=t.join(""),s={...JSON.parse(a)};return Object.keys(e).forEach(t=>{isNaN(Number(t))&&(s[t]=e[t])}),s}catch{}return e};function D({initialMedias:e,onSelect:C,allowSelection:F=!1}){let[R,P]=(0,a.useState)(e),[B,D]=(0,a.useState)([]),[T,E]=(0,a.useState)(""),[O,I]=(0,a.useState)("all"),[q,H]=(0,a.useState)(null),[G,J]=(0,a.useState)(null),[V,K]=(0,a.useState)(!1),W=(0,w.useRouter)(),[X,Z]=(0,a.useState)(new Set),[_,Q]=(0,a.useState)(new Set),[Y,ee]=(0,a.useState)(!1),[et,ea]=(0,a.useState)(null),[es,er]=(0,a.useState)(null);(0,a.useEffect)(()=>{P(t=>JSON.stringify(t)===JSON.stringify(e)?t:e),es&&er(t=>{if(!t)return null;let a=e.find(e=>e.id===t.id);return a&&JSON.stringify(a)!==JSON.stringify(t)?a:t})},[e]),(0,a.useEffect)(()=>{Z(e=>0===e.size?e:new Set),Q(e=>0===e.size?e:new Set)},[q]),(0,a.useEffect)(()=>{(async()=>{D(await (0,y.getPhysicalFolders)())})()},[]);let el=e=>{let t=$(e.metadata);if(t?.folder)return t.folder;let a=e.url,s="";if(!a.startsWith("/uploads/"))return null;let r=(s=a.replace("/uploads/","")).split("/").filter(Boolean);return r.length>1?r.slice(0,-1).join("/"):null},ei=(0,a.useMemo)(()=>{let e=new Set;return R.forEach(t=>{let a=el(t);if(a){let t=a.split("/");for(let a=1;a<=t.length;a++)e.add(t.slice(0,a).join("/"))}}),B.forEach(t=>{let a=t.replace(/\\/g,"/").split("/");for(let t=1;t<=a.length;t++)e.add(a.slice(0,t).join("/"))}),Array.from(e).sort()},[R,B]),en=(0,a.useMemo)(()=>T?[]:ei.filter(e=>q?e.startsWith(q+"/")&&e.split("/").length===q.split("/").length+1:!e.includes("/")),[ei,q,T]),ed=R.filter(e=>{let t=el(e),a=!!T||t===q,s=e.name.toLowerCase().includes(T.toLowerCase()),r="all"===O||e.type===O;return a&&s&&r}),eo=async e=>{if(!confirm("Apakah Anda yakin ingin menghapus media ini secara permanen?"))return;let t=await (0,f.deleteMedia)(e);t.success?(P(R.filter(t=>t.id!==e)),U.toast.success("Media berhasil dihapus"),W.refresh()):U.toast.error(t.message||"Gagal menghapus media")},ec=async()=>{let e=X.size+_.size;if(0===e||!confirm(`Hapus ${e} item yang dipilih? (Folder harus kosong)`))return;let t=0,a=[];for(let e of Array.from(_)){let s=await (0,f.deleteMedia)(e);s.success?(P(t=>t.filter(t=>t.id!==e)),t++):a.push(`Media #${e}: ${s.message}`)}for(let e of Array.from(X)){let s=await (0,j.deletePhysicalFolder)(e);s.success?(D(t=>t.filter(t=>t!==e)),t++):a.push(`Folder ${e}: ${s.message}`)}Z(new Set),Q(new Set),t>0&&U.toast.success(`Berhasil menghapus ${t} item.`),a.length>0&&U.toast.error(`Gagal menghapus beberapa item: ${a[0]}`),W.refresh()},eu=(e,t)=>{t?.stopPropagation();let a=new Set(_);F?a.has(e)?a.clear():(a.clear(),a.add(e)):a.has(e)?a.delete(e):a.add(e),Q(a)},ex=async()=>{K(!0);let e=await (0,b.syncFileSystemMedias)();D(await (0,y.getPhysicalFolders)()),K(!1),e.success?(U.toast.success(e.message||"Sinkronisasi berhasil"),W.refresh()):U.toast.error(e.message||"Sinkronisasi gagal")},eh=async e=>{if(!et)return;let t=await (0,g.updateMediaFolder)(et.id,e);t.success?(U.toast.success("Media berhasil dipindahkan"),W.refresh()):U.toast.error(t.message||"Gagal memindahkan media"),ea(null)},ep=async e=>{let t=q?`${q}/${e}`:e,a=await (0,v.createPhysicalFolder)(t);a.success?(U.toast.success(a.message||"Folder berhasil dibuat"),D(e=>[...e,t])):U.toast.error(a.message||"Gagal membuat folder")},em=async e=>{J(e);let t=await (0,N.syncMuxAssetStatus)(e);J(null),"ready"===t&&P(t=>t.map(t=>{if(t.id===e){let e=$(t.metadata);return{...t,metadata:{...e,status:"ready"}}}return t})),W.refresh()};return(0,a.useEffect)(()=>{if(!R.some(e=>{if("video"!==e.type||"mux"!==e.provider)return!1;let t=$(e.metadata);return t?.status!=="ready"}))return;let e=setInterval(()=>{W.refresh()},5e3);return()=>clearInterval(e)},[R,W]),(0,t.jsxs)("div",{className:"flex flex-col gap-6 relative min-h-[500px]",children:[(0,t.jsx)(M.FolderDialog,{isOpen:Y,onClose:()=>ee(!1),onCreate:ep,currentPath:q}),(0,t.jsx)(S.MoveMediaDialog,{isOpen:!!et,onClose:()=>ea(null),onMove:eh,existingFolders:ei,currentFolder:q}),(0,t.jsx)(z.MediaDetailsModal,{isOpen:!!es,onClose:()=>er(null),media:es,onDelete:eo,onMove:ea}),(0,t.jsx)("div",{className:"sticky top-0 z-20 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-4 bg-neutral-50 border-b border-neutral-200 transition-all duration-300",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs font-bold text-neutral-400 overflow-x-auto no-scrollbar whitespace-nowrap pb-1",children:[(0,t.jsxs)("button",{onClick:()=>H(null),className:`hover:text-brand-green transition-colors flex items-center gap-1 ${!q?"text-brand-green":""}`,children:[(0,t.jsx)(c.Folder,{size:14})," Root"]}),q?.split("/").map((e,a,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.ChevronRight,{size:12,className:"shrink-0"}),(0,t.jsx)("button",{onClick:()=>H(s.slice(0,a+1).join("/")),className:`hover:text-brand-green transition-colors ${a===s.length-1?"text-brand-green":""}`,children:e})]},a))]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center bg-white p-3 rounded-xl border border-neutral-200 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 flex-1 w-full md:w-auto",children:[(0,t.jsxs)("div",{className:"relative w-full md:w-80",children:[(0,t.jsx)(d.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400",size:18}),(0,t.jsx)("input",{type:"text",placeholder:"Cari media...",className:"pl-10 pr-4 py-2 border rounded-lg w-full text-sm bg-neutral-50 focus:bg-white transition-colors outline-none",value:T,onChange:e=>E(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[(0,t.jsx)(o.Filter,{size:16,className:"text-neutral-400"}),(0,t.jsxs)("select",{className:"p-2 border rounded-lg text-sm bg-white min-w-[120px] focus:ring-2 focus:ring-brand-green/20 w-full md:w-auto outline-none cursor-pointer",value:O,onChange:e=>I(e.target.value),children:[(0,t.jsx)("option",{value:"all",children:"Semua Tipe"}),(0,t.jsx)("option",{value:"image",children:"Gambar"}),(0,t.jsx)("option",{value:"video",children:"Video"}),(0,t.jsx)("option",{value:"document",children:"Dokumen"}),(0,t.jsx)("option",{value:"audio",children:"Audio"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 w-full md:w-auto justify-end",children:[(0,t.jsxs)(r.Button,{type:"button",variant:"outline",size:"sm",onClick:ex,disabled:V,className:"gap-2 text-neutral-600 border-neutral-200",children:[(0,t.jsx)(h.RefreshCcw,{size:16,className:V?"animate-spin":""}),(0,t.jsx)("span",{className:"hidden lg:inline",children:"Sinkron Assets"})]}),(0,t.jsxs)(r.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>ee(!0),className:"gap-2 text-neutral-600 border-neutral-200",children:[(0,t.jsx)(x.FolderPlus,{size:16}),(0,t.jsx)("span",{className:"hidden lg:inline",children:"Folder Baru"})]}),(0,t.jsx)(A,{currentFolder:q})]})]})]})}),0===ed.length&&0===en.length?(0,t.jsxs)("div",{className:"text-center py-24 bg-white rounded-xl border border-neutral-200 border-dashed",children:[(0,t.jsx)(c.Folder,{size:48,className:"mx-auto text-neutral-100 mb-4"}),(0,t.jsx)("p",{className:"text-neutral-400 font-medium",children:"Folder ini masih kosong."}),q&&(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:()=>H(null),className:"mt-4",children:"Kembali ke Root"})]}):(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4 pb-20",children:[en.map(e=>{let a=X.has(e);return(0,t.jsxs)("div",{onClick:()=>H(e),className:`group relative aspect-square rounded-xl overflow-hidden border transition-all flex flex-col items-center justify-center gap-3 p-4 cursor-pointer
                    ${a?"border-brand-green bg-brand-light/10 ring-2 ring-brand-green ring-offset-2":"border-neutral-200 bg-white hover:border-brand-green hover:shadow-md"}
                `,children:[!F&&(0,t.jsx)("div",{className:`absolute top-2 right-2 transition-opacity z-10 ${a?"opacity-100":"opacity-100 md:opacity-0 md:group-hover:opacity-100"}`,children:(0,t.jsx)("button",{onClick:t=>{let a;return t.stopPropagation(),void((a=new Set(X)).has(e)?a.delete(e):a.add(e),Z(a))},className:`p-1 rounded-full transition-colors border ${a?"bg-brand-green text-white border-brand-green":"bg-white text-neutral-400 border-neutral-200 hover:border-brand-green"}`,children:(0,t.jsx)(p.Check,{size:14,className:a?"stroke-[3px]":""})})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.Folder,{size:56,className:`transition-colors ${a?"text-brand-green fill-brand-green/20":"text-brand-light fill-brand-light stroke-brand-green/20 group-hover:stroke-brand-green/40"}`}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pt-1",children:(0,t.jsx)("span",{className:"text-[10px] font-black text-brand-green opacity-40",children:"DIR"})})]}),(0,t.jsx)("span",{className:"text-xs font-bold text-neutral-600 tracking-tighter truncate w-full text-center",children:e.split("/").pop()})]},e)}),ed.map(e=>{let a=$(e.metadata),d="video"===e.type&&"mux"===e.provider&&"ready"!==a.status,o=_.has(e.id);return(0,t.jsxs)("div",{className:`group relative aspect-square rounded-xl overflow-hidden border transition-all ${o?"border-brand-green bg-brand-light/10 ring-2 ring-brand-green ring-offset-2":F?"cursor-pointer hover:ring-2 hover:ring-brand-green hover:ring-offset-2 shadow-sm border-neutral-200 bg-white":"bg-white border-neutral-200 shadow-sm hover:shadow-md cursor-pointer"}`,onClick:()=>!d&&void(F?eu(e.id):er(e)),children:[!d&&(0,t.jsx)("div",{className:`absolute top-2 right-2 transition-opacity z-10 ${o?"opacity-100":"opacity-100 md:opacity-0 md:group-hover:opacity-100"}`,children:(0,t.jsx)("button",{onClick:t=>eu(e.id,t),className:`p-1 rounded-full transition-colors border ${o?"bg-brand-green text-white border-brand-green":"bg-white text-neutral-400 border-neutral-200 hover:border-brand-green"}`,children:(0,t.jsx)(p.Check,{size:14,className:o?"stroke-[3px]":""})})}),"image"===e.type||"video"===e.type&&"ready"===a.status?(0,t.jsxs)("div",{className:"relative w-full h-full",children:[(0,t.jsx)(s.AppImage,{src:(0,L.getDisplayUrl)(e),alt:e.name,fill:!0,className:"object-cover"}),"video"===e.type&&!d&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/10",children:(0,t.jsx)(l.Play,{size:32,className:"text-white fill-white opacity-80"})})]}):(0,t.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-transparent gap-2 p-2 text-center",children:["video"===e.type?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(l.Play,{size:32,className:d?"text-neutral-300":"text-brand-green"}),d&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(k.RefreshCw,{size:16,className:"text-neutral-400 animate-spin"})})]}):"audio"===e.type?(0,t.jsx)(n.Music,{size:32,className:"text-blue-500"}):(0,t.jsx)(i.FileText,{size:32,className:"text-neutral-400"}),(0,t.jsx)("span",{className:"text-[10px] font-bold text-neutral-500 uppercase line-clamp-1 px-2",children:e.name}),d&&(0,t.jsx)("span",{className:"text-[8px] bg-yellow-100 text-yellow-700 px-1 rounded font-black uppercase tracking-tighter",children:"Processing"})]}),d&&(0,t.jsx)("div",{className:"absolute inset-0 bg-white/40 flex items-center justify-center cursor-not-allowed",children:(0,t.jsx)("span",{className:"text-[10px] font-bold text-neutral-400 uppercase bg-white/80 px-2 py-1 rounded shadow-sm",children:"Wait..."})}),"video"===e.type&&d&&!F&&(0,t.jsx)("div",{className:"absolute top-2 right-2",children:(0,t.jsx)(r.Button,{variant:"outline",size:"sm",className:"h-7 w-7 p-0 bg-white border-white text-brand-green hover:bg-neutral-100 shadow-sm",onClick:t=>{t.stopPropagation(),em(e.id)},disabled:G===e.id,children:(0,t.jsx)(k.RefreshCw,{size:12,className:G===e.id?"animate-spin":""})})})]},e.id)})]}),(X.size>0||_.size>0)&&(0,t.jsxs)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 bg-white border border-neutral-200 shadow-xl rounded-full px-6 py-3 flex items-center gap-4 z-[110] animate-in slide-in-from-bottom-4",children:[(0,t.jsxs)("span",{className:"text-sm font-bold text-neutral-700",children:[X.size+_.size," terpilih"]}),(0,t.jsx)("div",{className:"h-4 w-px bg-neutral-200"}),F?(0,t.jsxs)("button",{onClick:()=>{if(0===_.size)return;let e=Array.from(_)[0],t=R.find(t=>t.id===e);t&&C&&(C(t),Q(new Set))},className:"flex items-center gap-2 text-brand-green hover:bg-brand-light/20 px-3 py-1.5 rounded-full transition-colors text-sm font-bold",children:[(0,t.jsx)(p.Check,{size:16}),"Gunakan Media"]}):(0,t.jsxs)("button",{onClick:ec,className:"flex items-center gap-2 text-red-600 hover:bg-red-50 px-3 py-1.5 rounded-full transition-colors text-sm font-bold",children:[(0,t.jsx)(m.Trash2,{size:16}),"Hapus"]}),(0,t.jsx)("button",{onClick:()=>{Z(new Set),Q(new Set)},className:"flex items-center gap-2 text-neutral-500 hover:bg-neutral-100 px-3 py-1.5 rounded-full transition-colors text-sm font-bold",children:"Batal"})]})]})}e.s(["MediaLibrary",()=>D],53978)}]);