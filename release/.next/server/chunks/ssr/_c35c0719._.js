module.exports=[10267,a=>{"use strict";let b=(0,a.i(72873).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],10267)},17691,a=>{"use strict";let b=(0,a.i(72873).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],17691)},77065,a=>{"use strict";var b=a.i(51959);let c=(0,b.createServerReference)("40d1fbcb5529ac8f2bc18816eb1d3c478818f9fbe2",b.callServer,void 0,b.findSourceMapURL,"uploadFile");a.s(["uploadFile",()=>c])},23081,a=>{"use strict";var b=a.i(51959);let c=(0,b.createServerReference)("4020377e801a0cc64e1a42febf16bf8e4995f2cf7f",b.callServer,void 0,b.findSourceMapURL,"deleteMedia");a.s(["deleteMedia",()=>c])},26152,39003,a=>{"use strict";var b=a.i(51959);let c=(0,b.createServerReference)("600e0cdbe2c8d63481951c01b9e5bebcf0b714ea4a",b.callServer,void 0,b.findSourceMapURL,"createMuxUpload");a.s(["createMuxUpload",()=>c],26152);let d=(0,b.createServerReference)("40525e4ba1a0943968fe44ab212718ec6b0c2f1338",b.callServer,void 0,b.findSourceMapURL,"getMuxMediaByUploadId");a.s(["getMuxMediaByUploadId",()=>d],39003)},38521,97761,33670,80098,a=>{"use strict";var b=a.i(72873);let c=(0,b.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);a.s(["Filter",()=>c],38521);let d=(0,b.default)("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);a.s(["FolderPlus",()=>d],97761);let e=(0,b.default)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);a.s(["RefreshCcw",()=>e],33670);let f=(0,b.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>f],80098)},76508,35450,79014,60354,48462,51268,57005,48313,38505,a=>{"use strict";var b=a.i(51959);let c=(0,b.createServerReference)("60a088e6d105144a94fa2824812100df7fdd6a8818",b.callServer,void 0,b.findSourceMapURL,"updateMediaFolder");a.s(["updateMediaFolder",()=>c],76508);let d=(0,b.createServerReference)("00407ab671b4a0818fff7ed31ffb79f10f964adcd8",b.callServer,void 0,b.findSourceMapURL,"syncFileSystemMedias");a.s(["syncFileSystemMedias",()=>d],35450);let e=(0,b.createServerReference)("406ff7d3af401edf92b2984e240871274e46bb3446",b.callServer,void 0,b.findSourceMapURL,"createPhysicalFolder");a.s(["createPhysicalFolder",()=>e],79014);let f=(0,b.createServerReference)("0039e6f4d93c612e9432cd78ee8cbc92260a14fa7c",b.callServer,void 0,b.findSourceMapURL,"getPhysicalFolders");a.s(["getPhysicalFolders",()=>f],60354);let g=(0,b.createServerReference)("40c944e5b0c4c33ee1ee96067b7c69a49106edc40b",b.callServer,void 0,b.findSourceMapURL,"deletePhysicalFolder");a.s(["deletePhysicalFolder",()=>g],48462);let h=(0,b.createServerReference)("4061d271ac6c933535c19513a8303b6043c76aa3b4",b.callServer,void 0,b.findSourceMapURL,"syncMuxAssetStatus");a.s(["syncMuxAssetStatus",()=>h],51268);let i=(0,a.i(72873).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>i],57005);var j=a.i(50586),k=a.i(98416),l=a.i(92989),m=a.i(83589);function n({isOpen:a,onClose:b,title:c,children:d,footer:e}){let[f,g]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{g(!0)},[]),(0,l.useEffect)(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[a]),f&&a)?(0,m.createPortal)((0,j.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:(0,j.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-200 border border-neutral-200",children:[(0,j.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-neutral-100",children:[(0,j.jsx)("h3",{className:"font-bold text-lg text-neutral-900",children:c}),(0,j.jsx)("button",{onClick:b,className:"p-1 rounded-full hover:bg-neutral-100 text-neutral-500 transition-colors",children:(0,j.jsx)(k.X,{size:20})})]}),(0,j.jsx)("div",{className:"p-4 overflow-y-auto max-h-[70vh]",children:d}),e&&(0,j.jsx)("div",{className:"p-4 bg-neutral-50 border-t border-neutral-100 flex justify-end gap-2",children:e})]})}),document.body):null}a.s(["Modal",()=>n],48313);var o=a.i(96438);function p({isOpen:a,onClose:b,onCreate:c,currentPath:d}){let[e,f]=(0,l.useState)("");return(0,j.jsx)(n,{isOpen:a,onClose:b,title:"Buat Folder Baru",children:(0,j.jsxs)("form",{onSubmit:a=>{a.preventDefault(),e.trim()&&(c(e.trim()),f(""),b())},className:"flex flex-col gap-4",children:[(0,j.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,j.jsx)("label",{className:"text-sm font-bold text-neutral-700",children:"Nama Folder"}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[d&&(0,j.jsxs)("span",{className:"text-neutral-400 text-sm",children:[d,"/"]}),(0,j.jsx)("input",{autoFocus:!0,type:"text",className:"p-2 border rounded-lg flex-1",placeholder:"Contoh: products",value:e,onChange:a=>f(a.target.value)})]}),(0,j.jsx)("p",{className:"text-xs text-neutral-500",children:"Folder hanya akan tersimpan jika berisi file."})]}),(0,j.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,j.jsx)(o.Button,{type:"button",variant:"outline",onClick:b,children:"Batal"}),(0,j.jsx)(o.Button,{type:"submit",disabled:!e.trim(),children:"Buat Folder"})]})]})})}a.s(["FolderDialog",()=>p],38505)},27267,99343,a=>{"use strict";var b=a.i(50586),c=a.i(48313),d=a.i(96438),e=a.i(92989),f=a.i(10267),g=a.i(17507),h=a.i(52693);function i({isOpen:a,onClose:i,onMove:j,existingFolders:k,currentFolder:l}){let[m,n]=(0,e.useState)(l),[o,p]=(0,e.useState)(!1),[q,r]=(0,e.useState)(""),s=(0,e.useMemo)(()=>{let a=[];return a.push({id:"root",label:"Root (Tanpa Folder)",path:null}),k.forEach(b=>{let c,d,e;return c=b.split("/"),d=a,e="",void c.forEach((a,b)=>{e=e?`${e}/${a}`:a;let f=d.find(b=>b.label===a&&"root"!==b.id);f||(f={id:e,label:a,path:e,children:[]},d.push(f)),b<c.length-1&&(f.children||(f.children=[]),d=f.children)})}),a},[k]);return(0,b.jsx)(c.Modal,{isOpen:a,onClose:i,title:"Pindahkan Media",children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)("p",{className:"text-sm text-neutral-500",children:"Pilih folder tujuan."}),(0,b.jsx)("div",{className:"max-h-[300px] overflow-y-auto border rounded-lg p-2 bg-white",children:(0,b.jsx)(h.CollapsibleTree,{nodes:s,renderLabel:a=>{let c=m===a.path;return(0,b.jsxs)("button",{type:"button",onClick:()=>{n(a.path??null),p(!1)},className:`flex items-center gap-2 w-full p-1 rounded text-sm text-left hover:bg-neutral-100 transition-all ${c?"text-brand-green font-bold bg-brand-light/20":"text-neutral-700"}`,children:[(0,b.jsx)(g.Folder,{size:14,className:c?"fill-brand-green/20 stroke-brand-green":"text-neutral-400"}),(0,b.jsx)("span",{children:a.label})]})},defaultExpanded:!0})}),(0,b.jsxs)("div",{className:"border-t border-neutral-200 pt-4",children:[(0,b.jsxs)("button",{onClick:()=>p(!o),className:"flex items-center gap-2 text-sm font-bold text-brand-green mb-2",children:[(0,b.jsx)(f.Plus,{size:16})," Folder Baru"]}),o&&(0,b.jsx)("div",{className:"flex flex-col gap-2 animate-in slide-in-from-top-2 duration-200",children:(0,b.jsx)("input",{type:"text",placeholder:"Nama folder baru (contoh: archive/2024)",className:"p-2 border rounded text-sm",value:q,onChange:a=>r(a.target.value),autoFocus:!0})})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:i,children:"Batal"}),(0,b.jsx)(d.Button,{onClick:()=>{o?j(q.trim()||null):j(m),i()},disabled:o&&!q.trim(),children:"Pindahkan"})]})]})})}a.s(["MoveMediaDialog",()=>i],27267);var j=a.i(68114),k=a.i(43102),l=a.i(72873);let m=(0,l.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),n=(0,l.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),o=(0,l.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),p=(0,l.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),q=(0,l.default)("file-type",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]]),r=(0,l.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),s=(0,l.default)("move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]);var t=a.i(84285),u=a.i(79244);let v=(0,l.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var w=a.i(37258),x=a.i(82044),y=a.i(64229),z=a.i(38211);function A({isOpen:a,onClose:f,media:g,onMove:h,onDelete:i}){let[l,A]=(0,e.useState)(!1);if(!g)return null;let B=(0,j.parseMetadata)(g.metadata),C=B.folder||(g.url.split("/").length>3?g.url.split("/").slice(2,-1).join("/"):"Root"),D="video"===g.type&&"mux"===g.provider&&"ready"===B.status;return(0,b.jsxs)(c.Modal,{isOpen:a,onClose:f,title:"Detail Media",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,b.jsx)("div",{className:"w-full bg-neutral-100 rounded-lg overflow-hidden flex items-center justify-center border border-neutral-200 aspect-video relative group",children:"image"===g.type?(0,b.jsxs)("div",{className:"relative w-full h-full cursor-zoom-in",onClick:()=>A(!0),children:[(0,b.jsx)(k.AppImage,{src:g.url,alt:g.name,fill:!0,className:"object-contain"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/5 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,b.jsx)("div",{className:"bg-white/90 p-2 rounded-full shadow-lg",children:(0,b.jsx)(v,{size:20,className:"text-neutral-700"})})})]}):D?(0,b.jsx)(x.default,{playbackId:B.playbackId,metadata:{video_title:g.name},style:{height:"100%",width:"100%"}}):(0,b.jsxs)("div",{className:"p-12 flex flex-col items-center justify-center gap-4 text-neutral-400",children:["video"===g.type?(0,b.jsx)(u.Play,{size:48,className:"animate-pulse"}):(0,b.jsx)(q,{size:48}),(0,b.jsx)("span",{className:"text-sm font-mono",children:g.mimeType}),"video"===g.type&&!D&&(0,b.jsx)("span",{className:"text-[10px] font-bold uppercase bg-yellow-100 text-yellow-700 px-2 py-1 rounded",children:"Processing..."})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,b.jsx)(p,{size:12})," Ukuran File"]}),(0,b.jsxs)("span",{className:"font-medium text-neutral-900",children:[(g.fileSize/1024).toFixed(2)," KB"]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,b.jsx)(q,{size:12})," Tipe MIME"]}),(0,b.jsx)("span",{className:"font-medium text-neutral-900",children:g.mimeType})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,b.jsx)(r,{size:12})," Folder"]}),(0,b.jsx)("span",{className:"font-medium text-neutral-900",children:C})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("span",{className:"text-neutral-500 text-xs flex items-center gap-1",children:[(0,b.jsx)(o,{size:12})," Diunggah"]}),(0,b.jsx)("span",{className:"font-medium text-neutral-900",children:new Date(g.createdAt).toLocaleDateString("id-ID")})]})]}),(0,b.jsx)("div",{className:"bg-neutral-50 p-3 rounded border border-neutral-100 break-all text-xs font-mono text-neutral-600",children:g.name}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 pt-4 border-t border-neutral-200",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[h&&(0,b.jsxs)(d.Button,{variant:"outline",onClick:()=>{h(g),f()},size:"sm",className:"gap-2 justify-start",children:[(0,b.jsx)(s,{size:16,className:"text-blue-600"})," Pindahkan"]}),i&&(0,b.jsxs)(d.Button,{variant:"outline",onClick:()=>{i(g.id),f()},size:"sm",className:"gap-2 justify-start text-red-600 hover:bg-red-50 border-red-200",children:[(0,b.jsx)(t.Trash2,{size:16})," Hapus Permanen"]})]}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,b.jsxs)(d.Button,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(g.url),w.toast.success("URL disalin ke clipboard!")},size:"sm",className:"gap-2",children:[(0,b.jsx)(n,{size:16})," Salin URL"]}),(0,b.jsx)("a",{href:g.url,download:!0,target:"_blank",rel:"noreferrer",children:(0,b.jsxs)(d.Button,{variant:"dark",size:"sm",className:"gap-2",children:[(0,b.jsx)(m,{size:16})," Download"]})})]})]})]}),"image"===g.type&&(0,b.jsx)(y.default,{open:l,close:()=>A(!1),slides:[{src:g.url,alt:g.name}],plugins:[z.default],zoom:{maxZoomPixelRatio:3}})]})}a.s(["MediaDetailsModal",()=>A],99343)},53273,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(43102),e=a.i(96438),f=a.i(79244),g=a.i(3866),h=a.i(43986),i=a.i(17691),j=a.i(38521),k=a.i(17507),l=a.i(25246),m=a.i(97761),n=a.i(33670),o=a.i(80098),p=a.i(84285),q=a.i(23081),r=a.i(76508),s=a.i(35450),t=a.i(79014),u=a.i(60354),v=a.i(48462),w=a.i(51268),x=a.i(28973),y=a.i(57005),z=a.i(38505),A=a.i(27267),B=a.i(99343),C=a.i(10267),D=a.i(98416),E=a.i(77065),F=a.i(26152),G=a.i(39003),H=a.i(37258);function I({currentFolder:a}){let[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)(0),h=(0,x.useRouter)(),i=(0,c.useRef)(null),j=(0,c.useRef)(null),k=async()=>{i.current&&(i.current.abort(),i.current=null,j.current&&(await (0,q.deleteMedia)(j.current),j.current=null),e(!1),g(0),H.toast.info("Unggahan dibatalkan"))},l=async b=>{if(b){e(!0),g(0);try{if(b.type.startsWith("video/")){let c=await (0,F.createMuxUpload)(b.name,a),d=await (0,G.getMuxMediaByUploadId)(c.id);d&&(j.current=d.id);let e=new XMLHttpRequest;i.current=e,e.open("PUT",c.url),e.upload.onprogress=a=>{a.lengthComputable&&g(Math.round(a.loaded/a.total*100))};let f=new Promise((a,b)=>{e.onload=()=>e.status>=200&&e.status<300?a(e.response):b(Error("Mux upload failed")),e.onerror=()=>b(Error("Mux upload error")),e.onabort=()=>b("ABORTED")});e.send(b),await f,i.current=null,j.current=null;let h=0;for(;h<10;)try{let a=await (0,G.getMuxMediaByUploadId)(c.id);if(a&&a.url)break;h++,await new Promise(a=>setTimeout(a,2e3))}catch{h++,await new Promise(a=>setTimeout(a,2e3))}H.toast.success("Video berhasil diunggah")}else{let c=new FormData;c.append("file",b),a&&c.append("folder",a);let d=await (0,E.uploadFile)(c);d.error?H.toast.error(d.error):H.toast.success("File berhasil diunggah")}h.refresh()}catch(a){if("ABORTED"===a)return;console.error("Upload error:",a),H.toast.error("Gagal mengunggah file.")}finally{e(!1),g(0)}}};return(0,b.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,b.jsx)("input",{type:"file",id:"media-upload",className:"hidden",onChange:a=>a.target.files?.[0]&&l(a.target.files[0]),disabled:d}),(0,b.jsx)("label",{htmlFor:"media-upload",className:"inline-flex items-center justify-center rounded-brand transition-all active:scale-95 disabled:opacity-50 bg-brand-dark text-white hover:bg-black px-4 py-2 text-sm font-medium gap-2 shadow-lg cursor-pointer",children:d?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,b.jsx)("span",{children:f>0?`${f}%`:"Mengunggah..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(C.Plus,{size:18}),(0,b.jsx)("span",{children:"Unggah Media"})]})}),d&&(0,b.jsx)("button",{onClick:k,className:"p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition-colors shadow-sm",title:"Batalkan Unggahan",children:(0,b.jsx)(D.X,{size:16})})]})}var J=a.i(68114);let K=a=>{if(!a)return{};if("string"==typeof a)try{return JSON.parse(a)}catch{return{}}if("object"==typeof a&&null!==a&&"0"in a&&"1"in a)try{let b=[];Object.keys(a).forEach(c=>{isNaN(Number(c))||(b[b.length]=a[c])});let c=b.join(""),d={...JSON.parse(c)};return Object.keys(a).forEach(b=>{isNaN(Number(b))&&(d[b]=a[b])}),d}catch{}return a};function L({initialMedias:a,onSelect:C,allowSelection:D=!1}){let[E,F]=(0,c.useState)(a),[G,L]=(0,c.useState)([]),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)("all"),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(null),[U,V]=(0,c.useState)(!1),W=(0,x.useRouter)(),[X,Y]=(0,c.useState)(new Set),[Z,$]=(0,c.useState)(new Set),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(null),[ad,ae]=(0,c.useState)(null);(0,c.useEffect)(()=>{F(b=>JSON.stringify(b)===JSON.stringify(a)?b:a),ad&&ae(b=>{if(!b)return null;let c=a.find(a=>a.id===b.id);return c&&JSON.stringify(c)!==JSON.stringify(b)?c:b})},[a]),(0,c.useEffect)(()=>{Y(a=>0===a.size?a:new Set),$(a=>0===a.size?a:new Set)},[Q]),(0,c.useEffect)(()=>{(async()=>{L(await (0,u.getPhysicalFolders)())})()},[]);let af=a=>{let b=K(a.metadata);if(b?.folder)return b.folder;let c=a.url,d="";if(!c.startsWith("/uploads/"))return null;let e=(d=c.replace("/uploads/","")).split("/").filter(Boolean);return e.length>1?e.slice(0,-1).join("/"):null},ag=(0,c.useMemo)(()=>{let a=new Set;return E.forEach(b=>{let c=af(b);if(c){let b=c.split("/");for(let c=1;c<=b.length;c++)a.add(b.slice(0,c).join("/"))}}),G.forEach(b=>{let c=b.replace(/\\/g,"/").split("/");for(let b=1;b<=c.length;b++)a.add(c.slice(0,b).join("/"))}),Array.from(a).sort()},[E,G]),ah=(0,c.useMemo)(()=>M?[]:ag.filter(a=>Q?a.startsWith(Q+"/")&&a.split("/").length===Q.split("/").length+1:!a.includes("/")),[ag,Q,M]),ai=E.filter(a=>{let b=af(a),c=!!M||b===Q,d=a.name.toLowerCase().includes(M.toLowerCase()),e="all"===O||a.type===O;return c&&d&&e}),aj=async a=>{if(!confirm("Apakah Anda yakin ingin menghapus media ini secara permanen?"))return;let b=await (0,q.deleteMedia)(a);b.success?(F(E.filter(b=>b.id!==a)),H.toast.success("Media berhasil dihapus"),W.refresh()):H.toast.error(b.message||"Gagal menghapus media")},ak=async()=>{let a=X.size+Z.size;if(0===a||!confirm(`Hapus ${a} item yang dipilih? (Folder harus kosong)`))return;let b=0,c=[];for(let a of Array.from(Z)){let d=await (0,q.deleteMedia)(a);d.success?(F(b=>b.filter(b=>b.id!==a)),b++):c.push(`Media #${a}: ${d.message}`)}for(let a of Array.from(X)){let d=await (0,v.deletePhysicalFolder)(a);d.success?(L(b=>b.filter(b=>b!==a)),b++):c.push(`Folder ${a}: ${d.message}`)}Y(new Set),$(new Set),b>0&&H.toast.success(`Berhasil menghapus ${b} item.`),c.length>0&&H.toast.error(`Gagal menghapus beberapa item: ${c[0]}`),W.refresh()},al=(a,b)=>{b?.stopPropagation();let c=new Set(Z);D?c.has(a)?c.clear():(c.clear(),c.add(a)):c.has(a)?c.delete(a):c.add(a),$(c)},am=async()=>{V(!0);let a=await (0,s.syncFileSystemMedias)();L(await (0,u.getPhysicalFolders)()),V(!1),a.success?(H.toast.success(a.message||"Sinkronisasi berhasil"),W.refresh()):H.toast.error(a.message||"Sinkronisasi gagal")},an=async a=>{if(!ab)return;let b=await (0,r.updateMediaFolder)(ab.id,a);b.success?(H.toast.success("Media berhasil dipindahkan"),W.refresh()):H.toast.error(b.message||"Gagal memindahkan media"),ac(null)},ao=async a=>{let b=Q?`${Q}/${a}`:a,c=await (0,t.createPhysicalFolder)(b);c.success?(H.toast.success(c.message||"Folder berhasil dibuat"),L(a=>[...a,b])):H.toast.error(c.message||"Gagal membuat folder")},ap=async a=>{T(a);let b=await (0,w.syncMuxAssetStatus)(a);T(null),"ready"===b&&F(b=>b.map(b=>{if(b.id===a){let a=K(b.metadata);return{...b,metadata:{...a,status:"ready"}}}return b})),W.refresh()};return(0,c.useEffect)(()=>{if(!E.some(a=>{if("video"!==a.type||"mux"!==a.provider)return!1;let b=K(a.metadata);return b?.status!=="ready"}))return;let a=setInterval(()=>{W.refresh()},5e3);return()=>clearInterval(a)},[E,W]),(0,b.jsxs)("div",{className:"flex flex-col gap-6 relative min-h-[500px]",children:[(0,b.jsx)(z.FolderDialog,{isOpen:_,onClose:()=>aa(!1),onCreate:ao,currentPath:Q}),(0,b.jsx)(A.MoveMediaDialog,{isOpen:!!ab,onClose:()=>ac(null),onMove:an,existingFolders:ag,currentFolder:Q}),(0,b.jsx)(B.MediaDetailsModal,{isOpen:!!ad,onClose:()=>ae(null),media:ad,onDelete:aj,onMove:ac}),(0,b.jsx)("div",{className:"sticky top-0 z-20 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-4 bg-neutral-50 border-b border-neutral-200 transition-all duration-300",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs font-bold text-neutral-400 overflow-x-auto no-scrollbar whitespace-nowrap pb-1",children:[(0,b.jsxs)("button",{onClick:()=>R(null),className:`hover:text-brand-green transition-colors flex items-center gap-1 ${!Q?"text-brand-green":""}`,children:[(0,b.jsx)(k.Folder,{size:14})," Root"]}),Q?.split("/").map((a,c,d)=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.ChevronRight,{size:12,className:"shrink-0"}),(0,b.jsx)("button",{onClick:()=>R(d.slice(0,c+1).join("/")),className:`hover:text-brand-green transition-colors ${c===d.length-1?"text-brand-green":""}`,children:a})]},c))]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center bg-white p-3 rounded-xl border border-neutral-200 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 flex-1 w-full md:w-auto",children:[(0,b.jsxs)("div",{className:"relative w-full md:w-80",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400",size:18}),(0,b.jsx)("input",{type:"text",placeholder:"Cari media...",className:"pl-10 pr-4 py-2 border rounded-lg w-full text-sm bg-neutral-50 focus:bg-white transition-colors outline-none",value:M,onChange:a=>N(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[(0,b.jsx)(j.Filter,{size:16,className:"text-neutral-400"}),(0,b.jsxs)("select",{className:"p-2 border rounded-lg text-sm bg-white min-w-[120px] focus:ring-2 focus:ring-brand-green/20 w-full md:w-auto outline-none cursor-pointer",value:O,onChange:a=>P(a.target.value),children:[(0,b.jsx)("option",{value:"all",children:"Semua Tipe"}),(0,b.jsx)("option",{value:"image",children:"Gambar"}),(0,b.jsx)("option",{value:"video",children:"Video"}),(0,b.jsx)("option",{value:"document",children:"Dokumen"}),(0,b.jsx)("option",{value:"audio",children:"Audio"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 w-full md:w-auto justify-end",children:[(0,b.jsxs)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:am,disabled:U,className:"gap-2 text-neutral-600 border-neutral-200",children:[(0,b.jsx)(n.RefreshCcw,{size:16,className:U?"animate-spin":""}),(0,b.jsx)("span",{className:"hidden lg:inline",children:"Sinkron Assets"})]}),(0,b.jsxs)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>aa(!0),className:"gap-2 text-neutral-600 border-neutral-200",children:[(0,b.jsx)(m.FolderPlus,{size:16}),(0,b.jsx)("span",{className:"hidden lg:inline",children:"Folder Baru"})]}),(0,b.jsx)(I,{currentFolder:Q})]})]})]})}),0===ai.length&&0===ah.length?(0,b.jsxs)("div",{className:"text-center py-24 bg-white rounded-xl border border-neutral-200 border-dashed",children:[(0,b.jsx)(k.Folder,{size:48,className:"mx-auto text-neutral-100 mb-4"}),(0,b.jsx)("p",{className:"text-neutral-400 font-medium",children:"Folder ini masih kosong."}),Q&&(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>R(null),className:"mt-4",children:"Kembali ke Root"})]}):(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4 pb-20",children:[ah.map(a=>{let c=X.has(a);return(0,b.jsxs)("div",{onClick:()=>R(a),className:`group relative aspect-square rounded-xl overflow-hidden border transition-all flex flex-col items-center justify-center gap-3 p-4 cursor-pointer
                    ${c?"border-brand-green bg-brand-light/10 ring-2 ring-brand-green ring-offset-2":"border-neutral-200 bg-white hover:border-brand-green hover:shadow-md"}
                `,children:[!D&&(0,b.jsx)("div",{className:`absolute top-2 right-2 transition-opacity z-10 ${c?"opacity-100":"opacity-100 md:opacity-0 md:group-hover:opacity-100"}`,children:(0,b.jsx)("button",{onClick:b=>{let c;return b.stopPropagation(),void((c=new Set(X)).has(a)?c.delete(a):c.add(a),Y(c))},className:`p-1 rounded-full transition-colors border ${c?"bg-brand-green text-white border-brand-green":"bg-white text-neutral-400 border-neutral-200 hover:border-brand-green"}`,children:(0,b.jsx)(o.Check,{size:14,className:c?"stroke-[3px]":""})})}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Folder,{size:56,className:`transition-colors ${c?"text-brand-green fill-brand-green/20":"text-brand-light fill-brand-light stroke-brand-green/20 group-hover:stroke-brand-green/40"}`}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pt-1",children:(0,b.jsx)("span",{className:"text-[10px] font-black text-brand-green opacity-40",children:"DIR"})})]}),(0,b.jsx)("span",{className:"text-xs font-bold text-neutral-600 tracking-tighter truncate w-full text-center",children:a.split("/").pop()})]},a)}),ai.map(a=>{let c=K(a.metadata),i="video"===a.type&&"mux"===a.provider&&"ready"!==c.status,j=Z.has(a.id);return(0,b.jsxs)("div",{className:`group relative aspect-square rounded-xl overflow-hidden border transition-all ${j?"border-brand-green bg-brand-light/10 ring-2 ring-brand-green ring-offset-2":D?"cursor-pointer hover:ring-2 hover:ring-brand-green hover:ring-offset-2 shadow-sm border-neutral-200 bg-white":"bg-white border-neutral-200 shadow-sm hover:shadow-md cursor-pointer"}`,onClick:()=>!i&&void(D?al(a.id):ae(a)),children:[!i&&(0,b.jsx)("div",{className:`absolute top-2 right-2 transition-opacity z-10 ${j?"opacity-100":"opacity-100 md:opacity-0 md:group-hover:opacity-100"}`,children:(0,b.jsx)("button",{onClick:b=>al(a.id,b),className:`p-1 rounded-full transition-colors border ${j?"bg-brand-green text-white border-brand-green":"bg-white text-neutral-400 border-neutral-200 hover:border-brand-green"}`,children:(0,b.jsx)(o.Check,{size:14,className:j?"stroke-[3px]":""})})}),"image"===a.type||"video"===a.type&&"ready"===c.status?(0,b.jsxs)("div",{className:"relative w-full h-full",children:[(0,b.jsx)(d.AppImage,{src:(0,J.getDisplayUrl)(a),alt:a.name,fill:!0,className:"object-cover"}),"video"===a.type&&!i&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/10",children:(0,b.jsx)(f.Play,{size:32,className:"text-white fill-white opacity-80"})})]}):(0,b.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-transparent gap-2 p-2 text-center",children:["video"===a.type?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Play,{size:32,className:i?"text-neutral-300":"text-brand-green"}),i&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsx)(y.RefreshCw,{size:16,className:"text-neutral-400 animate-spin"})})]}):"audio"===a.type?(0,b.jsx)(h.Music,{size:32,className:"text-blue-500"}):(0,b.jsx)(g.FileText,{size:32,className:"text-neutral-400"}),(0,b.jsx)("span",{className:"text-[10px] font-bold text-neutral-500 uppercase line-clamp-1 px-2",children:a.name}),i&&(0,b.jsx)("span",{className:"text-[8px] bg-yellow-100 text-yellow-700 px-1 rounded font-black uppercase tracking-tighter",children:"Processing"})]}),i&&(0,b.jsx)("div",{className:"absolute inset-0 bg-white/40 flex items-center justify-center cursor-not-allowed",children:(0,b.jsx)("span",{className:"text-[10px] font-bold text-neutral-400 uppercase bg-white/80 px-2 py-1 rounded shadow-sm",children:"Wait..."})}),"video"===a.type&&i&&!D&&(0,b.jsx)("div",{className:"absolute top-2 right-2",children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",className:"h-7 w-7 p-0 bg-white border-white text-brand-green hover:bg-neutral-100 shadow-sm",onClick:b=>{b.stopPropagation(),ap(a.id)},disabled:S===a.id,children:(0,b.jsx)(y.RefreshCw,{size:12,className:S===a.id?"animate-spin":""})})})]},a.id)})]}),(X.size>0||Z.size>0)&&(0,b.jsxs)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 bg-white border border-neutral-200 shadow-xl rounded-full px-6 py-3 flex items-center gap-4 z-[110] animate-in slide-in-from-bottom-4",children:[(0,b.jsxs)("span",{className:"text-sm font-bold text-neutral-700",children:[X.size+Z.size," terpilih"]}),(0,b.jsx)("div",{className:"h-4 w-px bg-neutral-200"}),D?(0,b.jsxs)("button",{onClick:()=>{if(0===Z.size)return;let a=Array.from(Z)[0],b=E.find(b=>b.id===a);b&&C&&(C(b),$(new Set))},className:"flex items-center gap-2 text-brand-green hover:bg-brand-light/20 px-3 py-1.5 rounded-full transition-colors text-sm font-bold",children:[(0,b.jsx)(o.Check,{size:16}),"Gunakan Media"]}):(0,b.jsxs)("button",{onClick:ak,className:"flex items-center gap-2 text-red-600 hover:bg-red-50 px-3 py-1.5 rounded-full transition-colors text-sm font-bold",children:[(0,b.jsx)(p.Trash2,{size:16}),"Hapus"]}),(0,b.jsx)("button",{onClick:()=>{Y(new Set),$(new Set)},className:"flex items-center gap-2 text-neutral-500 hover:bg-neutral-100 px-3 py-1.5 rounded-full transition-colors text-sm font-bold",children:"Batal"})]})]})}a.s(["MediaLibrary",()=>L],53273)}];

//# sourceMappingURL=_c35c0719._.js.map