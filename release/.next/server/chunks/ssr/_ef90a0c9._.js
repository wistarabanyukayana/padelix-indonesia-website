module.exports=[10235,a=>{"use strict";let b=(0,a.i(72873).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);a.s(["Image",()=>b],10235)},434,a=>{"use strict";let b=(0,a.i(72873).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],434)},55736,32994,a=>{"use strict";let b=(0,a.i(72873).default)("library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);a.s(["Library",()=>b],55736);var c=a.i(50586),d=a.i(92989),e=a.i(53273),f=a.i(96438),g=a.i(98416);function h({onSelect:a,allMedias:b,trigger:h}){let[i,j]=(0,d.useState)(!1);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{onClick:()=>j(!0),children:h||(0,c.jsx)(f.Button,{type:"button",variant:"outline",children:"Pilih dari Library"})}),i&&(0,c.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 sm:p-6",children:[(0,c.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>j(!1)}),(0,c.jsxs)("div",{className:"relative bg-white w-full max-w-6xl max-h-[90vh] rounded-2xl shadow-2xl flex flex-col overflow-hidden",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-neutral-100",children:[(0,c.jsx)("h3",{className:"text-xl font-bold text-neutral-900",children:"Pilih Media"}),(0,c.jsx)("button",{onClick:()=>j(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:(0,c.jsx)(g.X,{size:24})})]}),(0,c.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,c.jsx)("div",{className:"p-6",children:(0,c.jsx)(e.MediaLibrary,{initialMedias:b,allowSelection:!0,onSelect:b=>{a(b),j(!1)}})})}),(0,c.jsx)("div",{className:"p-4 bg-neutral-50 border-t text-center text-xs text-neutral-500",children:'Pilih media lalu klik "Gunakan Media" untuk mengonfirmasi.'})]})]})]})}a.s(["MediaSelector",()=>h],32994)},49892,a=>{"use strict";let b=(0,a.i(72873).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],49892)},52693,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(25246),e=a.i(64706);function f({node:a,renderLabel:g,level:h=0,defaultExpanded:i=!1}){let[j,k]=(0,c.useState)(i),l=a.children&&a.children.length>0;return(0,b.jsxs)("div",{className:"flex flex-col select-none",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 py-1",style:{paddingLeft:`${12*h}px`},children:[(0,b.jsx)("button",{type:"button",onClick:()=>l&&k(!j),className:`p-1 rounded hover:bg-neutral-100 text-neutral-400 transition-colors ${!l?"opacity-0 cursor-default":""}`,children:j?(0,b.jsx)(e.ChevronDown,{size:14}):(0,b.jsx)(d.ChevronRight,{size:14})}),(0,b.jsx)("div",{className:"flex-1 min-w-0",children:g(a)})]}),l&&j&&(0,b.jsx)("div",{className:"flex flex-col",children:a.children.map(a=>(0,b.jsx)(f,{node:a,renderLabel:g,level:h+1,defaultExpanded:i},a.id))})]})}function g({nodes:a,renderLabel:c,defaultExpanded:d=!1,className:e=""}){return(0,b.jsx)("div",{className:`flex flex-col ${e}`,children:a.map(a=>(0,b.jsx)(f,{node:a,renderLabel:c,defaultExpanded:d},a.id))})}a.s(["CollapsibleTree",()=>g])},84285,a=>{"use strict";let b=(0,a.i(72873).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],84285)},17507,a=>{"use strict";let b=(0,a.i(72873).default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);a.s(["Folder",()=>b],17507)},9394,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={default:function(){return k},getImageProps:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(63652),g=a.r(30775),h=a.r(59639),i=f._(a.r(6047));function j(a){let{props:b}=(0,g.getImgProps)(a,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[a,c]of Object.entries(b))void 0===c&&delete b[a];return{props:b}}let k=h.Image},55516,(a,b,c)=>{b.exports=a.r(9394)},43102,a=>{"use strict";var b=a.i(50586),c=a.i(55516),d=a.i(68114);function e({src:a,alt:e,className:f,fill:g,sizes:h,...i}){return a?(0,b.jsx)(c.default,{src:a,alt:e,fill:g,sizes:h||(g?"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw":void 0),className:(0,d.cn)("object-cover object-center",f),...i}):null}a.s(["AppImage",()=>e])},25246,a=>{"use strict";let b=(0,a.i(72873).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);a.s(["ChevronRight",()=>b],25246)},42559,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(96438),e=a.i(10267),f=a.i(84285),g=a.i(10235),h=a.i(434),i=a.i(49892),j=a.i(98416),k=a.i(17691),l=a.i(55736),m=a.i(79244),n=a.i(77065),o=a.i(23081),p=a.i(43102),q=a.i(74949),r=a.i(26152),s=a.i(39003),t=a.i(32994),u=a.i(99343),v=a.i(37258),w=a.i(68114);function x({action:a,initialData:x,allMedias:y,currentFolder:z}){let[A,B,C]=(0,c.useActionState)(a,{}),[D,E]=(0,c.useState)(null);(0,c.useEffect)(()=>{A?.message&&(A.success?v.toast.success(A.message):v.toast.error(A.message))},[A]);let[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(0),J=(0,c.useRef)(null),K=(0,c.useRef)(null),L=async()=>{J.current&&(J.current.abort(),J.current=null,K.current&&(await (0,o.deleteMedia)(K.current),K.current=null),G(null),I(0),v.toast.info("Unggahan dibatalkan"))},[M,N]=(0,c.useState)(x?.title||""),[O,P]=(0,c.useState)(x?.slug||""),[Q,R]=(0,c.useState)(x?.medias||[]),S=a=>{Q.some(b=>b.id===a.id)?v.toast.error("Media ini sudah ada di daftar."):R([...Q,{id:a.id,url:a.url,type:a.type,metadata:(0,w.parseMetadata)(a.metadata),isPrimary:0===Q.length,sortOrder:Q.length+1,altText:null}])},T=(a,b,c)=>{let d=[...Q];d[a][b]=c,"isPrimary"===b&&!0===c&&d.forEach((b,c)=>{c!==a&&(b.isPrimary=!1)}),R(d)},U=async(a,b)=>{if(b){G(a),I(0);try{if(b.type.startsWith("video/")){let c=await (0,r.createMuxUpload)(b.name,z),d=await (0,s.getMuxMediaByUploadId)(c.id);d&&(K.current=d.id);let e=new XMLHttpRequest;J.current=e,e.open("PUT",c.url),e.upload.onprogress=a=>{if(a.lengthComputable){let b=a.loaded/a.total*100;I(Math.round(b))}};let f=new Promise((a,b)=>{e.onload=()=>e.status>=200&&e.status<300?a(e.response):b(Error("Mux upload failed")),e.onerror=()=>b(Error("Mux upload error")),e.onabort=()=>b("ABORTED")});e.send(b),await f,J.current=null,K.current=null;let g=null,h=0;for(;h<10;)try{if((g=await (0,s.getMuxMediaByUploadId)(c.id))&&g.url)break;h++,await new Promise(a=>setTimeout(a,2e3))}catch{h++,await new Promise(a=>setTimeout(a,2e3))}if(g){let b=[...Q];b[a].url=g.url,b[a].id=g.id,b[a].type="video",b[a].metadata=(0,w.parseMetadata)(g.metadata),R(b)}}else{let c=new FormData;c.append("file",b);let d=await (0,n.uploadFile)(c);if(d.url&&d.id){let c=[...Q];c[a].url=d.url,c[a].id=d.id,c[a].metadata=null,b.type.startsWith("image/")?c[a].type="image":c[a].type="document",R(c)}else d.error&&v.toast.error(d.error)}}catch(a){if("ABORTED"===a)return;console.error("Upload error:",a),v.toast.error("Gagal mengunggah file.")}finally{G(null),I(0)}}},V=Q.filter(a=>0!==a.id);return(0,b.jsxs)("form",{action:B,className:"flex flex-col gap-8 w-full pb-32",children:[(0,b.jsx)("input",{type:"hidden",name:"medias",value:JSON.stringify(V)}),(0,b.jsx)(u.MediaDetailsModal,{isOpen:!!D,onClose:()=>E(null),media:D}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-brand shadow-sm border border-neutral-200",children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-neutral-900 mb-4 border-b pb-2",children:"Informasi Portofolio"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-neutral-700",children:"Judul Proyek"}),(0,b.jsx)("input",{name:"title",value:M,onChange:a=>{let b=a.target.value;N(b),x?.slug||P(b.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},className:"p-2 border rounded",required:!0}),A?.error?.title&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:A.error.title[0]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-neutral-700",children:"Slug (Otomatis)"}),(0,b.jsx)("input",{name:"slug",value:O,readOnly:!0,className:"p-2 border rounded bg-neutral-100 text-neutral-500 cursor-not-allowed"}),A?.error?.slug&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:A.error.slug[0]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 md:col-span-2",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-neutral-700",children:"Deskripsi"}),(0,b.jsx)("textarea",{name:"description",defaultValue:x?.description??"",className:"p-2 border rounded h-32 font-mono text-sm"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-neutral-700",children:"Lokasi"}),(0,b.jsx)("input",{name:"location",defaultValue:x?.location??"",className:"p-2 border rounded",placeholder:"Contoh: Jakarta Selatan"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-neutral-700",children:"Tanggal Selesai"}),(0,b.jsx)("input",{type:"date",name:"completionDate",defaultValue:x?.completionDate?new Date(x.completionDate).toISOString().split("T")[0]:"",className:"p-2 border rounded"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-x-8 gap-y-4 mt-2 md:col-span-2 p-4 bg-neutral-50 rounded-lg",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",name:"isActive",value:"true",defaultChecked:x?.isActive,className:"w-4 h-4 accent-brand-green"}),(0,b.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"Aktif (Tampil di web)"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",name:"isFeatured",value:"true",defaultChecked:x?.isFeatured,className:"w-4 h-4 accent-brand-green"}),(0,b.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"Featured (Unggulan)"})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-brand shadow-sm border border-neutral-200",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-neutral-900",children:"Media Proyek"}),(0,b.jsx)(t.MediaSelector,{allMedias:y,onSelect:S,trigger:(0,b.jsxs)(d.Button,{type:"button",variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,b.jsx)(k.Search,{size:14})," Library"]})})]}),(0,b.jsxs)("div",{className:"space-y-4 mb-4",children:[Q.map((a,c)=>(0,b.jsxs)("div",{className:"flex flex-col gap-4 p-4 bg-neutral-50 rounded border border-neutral-100 relative",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[(0,b.jsxs)("div",{className:`relative w-24 h-24 flex-shrink-0 rounded bg-white border border-neutral-200 overflow-hidden flex items-center justify-center ${0!==a.id?"cursor-pointer group/preview":""}`,onClick:()=>{if(0===a.id)return;let b=y.find(b=>b.id===a.id);b&&E(b)},children:[a.url?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.AppImage,{src:(0,w.getDisplayUrl)(a),alt:"Preview",fill:!0,className:"object-cover"}),"image"!==a.type&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/10",children:(0,b.jsx)(m.Play,{size:20,className:"text-white fill-white opacity-80"})}),0!==a.id&&(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover/preview:opacity-100 transition-opacity",children:(0,b.jsx)(k.Search,{size:20,className:"text-white"})})]}):(0,b.jsx)(g.Image,{className:"text-neutral-300",size:24}),F===c&&(0,b.jsxs)("div",{className:"absolute inset-0 bg-black/60 flex flex-col items-center justify-center gap-2 p-2",children:[(0,b.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),H>0&&(0,b.jsx)("div",{className:"w-full bg-white/20 h-1 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"bg-white h-full transition-all duration-300",style:{width:`${H}%`}})}),(0,b.jsx)("button",{type:"button",onClick:L,className:"mt-1 text-[8px] text-white font-black uppercase bg-red-600 px-2 py-0.5 rounded hover:bg-red-700 transition-colors",children:"Batal"})]})]}),(0,b.jsxs)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-12 gap-4 w-full",children:[(0,b.jsxs)("div",{className:"md:col-span-8 flex flex-col gap-2",children:[(0,b.jsx)("label",{className:"text-xs font-bold text-neutral-500 uppercase",children:"Aksi Media"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full z-10",accept:"*/*",onChange:a=>{a.target.files?.[0]&&U(c,a.target.files[0]),a.target.value=""}}),(0,b.jsxs)(d.Button,{type:"button",size:"sm",variant:"outline",className:"gap-2 bg-white",disabled:F===c,children:[(0,b.jsx)(h.Upload,{size:14}),(0,b.jsx)("span",{children:F===c?"Mengunggah...":"Upload Baru"})]})]}),(0,b.jsx)(t.MediaSelector,{allMedias:y,onSelect:a=>{let b=[...Q];b[c].id=a.id,b[c].url=a.url,b[c].type=a.type,R(b)},trigger:(0,b.jsxs)(d.Button,{type:"button",size:"sm",variant:"outline",className:"gap-2 bg-white",children:[(0,b.jsx)(l.Library,{size:14}),(0,b.jsx)("span",{children:"Ganti dari Library"})]})})]}),a.url&&(0,b.jsx)("p",{className:"text-[10px] text-neutral-400 truncate max-w-xs",children:a.url})]}),(0,b.jsxs)("div",{className:"md:col-span-2 flex flex-col gap-2",children:[(0,b.jsx)("label",{className:"text-xs font-bold text-neutral-500 uppercase",children:"Urutan"}),(0,b.jsx)("input",{type:"number",value:a.sortOrder??0,onChange:a=>T(c,"sortOrder",parseInt(a.target.value)),className:"p-2 border rounded text-sm w-full"})]}),(0,b.jsx)("div",{className:"md:col-span-2 flex items-center pt-0 md:pt-6",children:(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"radio",name:`primaryMedia-${c}`,checked:a.isPrimary??!1,onChange:()=>T(c,"isPrimary",!0),className:"w-4 h-4 accent-brand-green"}),(0,b.jsx)("span",{className:"text-xs font-bold text-neutral-700 uppercase",children:"Utama"})]})})]})]}),(0,b.jsxs)(d.Button,{type:"button",variant:"outline",size:"sm",className:"text-red-500 border-red-200 self-end",onClick:()=>{R(Q.filter((a,b)=>b!==c))},children:[(0,b.jsx)(f.Trash2,{size:14,className:"mr-2"})," Hapus"]})]},c)),0===Q.length&&(0,b.jsx)("p",{className:"text-sm text-neutral-400 italic text-center py-4",children:"Belum ada media."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>{R([...Q,{id:0,url:"",type:"image",isPrimary:0===Q.length,sortOrder:Q.length+1,altText:null}])},className:"w-full border-dashed",children:[(0,b.jsx)(e.Plus,{size:14,className:"mr-1"})," Tambah Media (Upload Baru)"]}),(0,b.jsx)(t.MediaSelector,{allMedias:y,onSelect:S,trigger:(0,b.jsxs)(d.Button,{type:"button",size:"sm",variant:"outline",className:"w-full border-dashed",children:[(0,b.jsx)(k.Search,{size:14,className:"mr-1"})," Pilih dari Library"]})})]})]}),(0,b.jsxs)("div",{className:"hidden md:flex justify-end gap-4 border-t border-neutral-200 pt-8",children:[(0,b.jsx)(q.default,{href:"/admin/portfolios",children:(0,b.jsx)(d.Button,{variant:"outline",size:"lg",children:"Batal"})}),(0,b.jsx)(d.Button,{variant:"dark",size:"lg",type:"submit",disabled:C,children:C?"Menyimpan...":"Simpan Portofolio"})]}),(0,b.jsx)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-md border-t border-neutral-200 p-4 z-40 flex justify-center shadow-[0_-4px_20px_rgba(0,0,0,0.08)]",children:(0,b.jsxs)("div",{className:"max-w-4xl w-full flex items-center justify-between gap-4 px-4",children:[(0,b.jsxs)(q.default,{href:"/admin/portfolios",className:"text-sm font-bold text-neutral-500 hover:text-neutral-700 flex items-center gap-1 transition-colors",children:[(0,b.jsx)(j.X,{size:16})," Batal"]}),(0,b.jsxs)(d.Button,{variant:"dark",size:"lg",type:"submit",disabled:C,className:"shadow-lg shadow-brand-green/20 px-8",children:[(0,b.jsx)(i.Save,{size:18,className:"mr-2"}),C?"Simpan...":"Simpan"]})]})})]})}a.s(["PortfolioForm",()=>x])}];

//# sourceMappingURL=_ef90a0c9._.js.map